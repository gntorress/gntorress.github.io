<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contact</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://kit.fontawesome.com/969b364b0b.js" crossorigin="anonymous"></script>
</head>
<body style="background-color: black;">
<nav style="background-color: black">
  <a href="index.html"><img src="images/logo.png" class="logo" alt="Logo"></a>
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="about.html">About</a></li>
    <li><a href="projects.html">Projects</a></li>
    <li><a href="contact.html">Contact</a></li>
    <li><a href="games.html">Games</a></li>
  </ul>
</nav>

<div id="contact">
  <div class="container"><br><br>
    <h1 class="sub-title" style="text-align: center;">Get in touch!</h1><br><br>
    <div class="row">
      <div class="contact-left">
        <h3 class="subInfo">General Info</h3>
        <p><i class="fa-solid fa-paper-plane"></i> gtorres7456@outlook.com</p>
        <p><i class="fa-solid fa-square-phone"></i> (864) 720-9116</p>
        <div class="social-icons">
          <a href="https://www.linkedin.com/in/gabriella-torres-santiago-b42a33237/" target="_blank"><i class="fa-brands fa-linkedin"></i></a>
          <a href="https://github.com/gntorress" target="_blank"><i class="fa-brands fa-github"></i></a>
          <a href="https://uscupstate.joinhandshake.com/profiles/czgdqa" target="_blank"><i class="fa-regular fa-handshake"></i></a>
        </div><br>
        <a href="gtorress_Resume.pdf" target="_blank" download class="btn btn2">Download PDF Resume</a>
      </div>

      <div class="contact-right">
        <form name="submit-to-google-sheet" autocomplete="off" novalidate>
          <input type="text" name="Name" placeholder="Your name" required />
          <input type="email" name="Email" placeholder="Your email" required />

          <!-- Dropdown menu -->
          <select id="dropdownMenu" name="dropdownMenu" required>
            <option value="" disabled selected hidden>What would you like to contact me about?</option>
            <option value="job-offer">Job Opportunity</option>
            <option value="question">Questions</option>
            <option value="other">Just to say hi!</option>
          </select>

          <textarea name="Message" rows="6" placeholder="Your message here"></textarea>
          <button type="submit" class="btn btn2" id="submitBtn">Submit</button>
        </form>
        <span id="msg" style="display:none;"></span>
      </div>
    </div>
  </div>
</div>

<!-- -----------Javascript----------- -->
<script>
  // ====== CONFIG ======
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwvZqm0TpLqUZo4PpsXKMATjtU3gUulVm0MeEft5TcgilIWeuBcHENxnx498yLXAgLR/exec';

  // ====== ELEMENTS ======
  const form = document.forms['submit-to-google-sheet'];
  const msg = document.getElementById('msg');
  const submitBtn = document.getElementById('submitBtn');

  // Track time on page to reduce instant bot submits
  const firstSeen = Date.now();

  function showMessage(text, ok = true) {
    msg.style.display = 'inline';
    msg.style.color = ok ? '#7CFC00' : '#ff6b6b';
    msg.textContent = text;
    setTimeout(() => { msg.style.display = 'none'; msg.textContent = ''; }, 5000);
  }

  function looksSpammy(text) {
    const links = (text.match(/https?:\/\//gi) || []).length;
    const badPhrases = [/crypto/i, /loan/i, /forex/i, /adult/i, /seo backlinks?/i];
    if (links > 3) return true;
    return badPhrases.some(r => r.test(text));
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    submitBtn.disabled = true;

    // Time-on-page (>= 5s)
    const elapsed = Date.now() - firstSeen;
    if (elapsed < 5000) {
      submitBtn.disabled = false;
      return;
    }

    const topic = form.querySelector('select[name="dropdownMenu"]')?.value || '';
    const message = form.querySelector('textarea[name="Message"]')?.value || '';

    if (!topic) { submitBtn.disabled = false; return; }
    if (message.trim().length < 20 || message.trim().length > 3000 || looksSpammy(message)) {
      submitBtn.disabled = false;
      return;
    }

    const fd = new FormData(form);

    try {
      const res = await fetch(scriptURL, { method: 'POST', body: fd });
      const text = (await res.text()).trim().toLowerCase();

      if (text === 'ok' || text === 'success') {
        showMessage('Your message has been sent! Thank you for contacting me!', true);
        form.reset();
      } else {
        showMessage('Sorry—your message could not be sent. Please try again.', false);
      }
    } catch (err) {
      console.error('Error!', err);
      showMessage('Network error—please try again.', false);
    } finally {
      submitBtn.disabled = false;
    }
  });
</script>
</body>
</html>
